###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         01/May/2023  08:14:44 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Components\HARDWARE\Rs485.c                     #
#    Command line       =  -f D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LE #
#                          D¿ØÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\. #
#                          .\..\..\Tools\CC2530DB\f8wCoord.cfg (-DCPU32MHZ    #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DZDO_COORDINATOR -DRTR_NWK -DBLINK_LEDS) -f     #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\Tools\CC2530DB\f8wConfig.cfg (-DSECURE=0      #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFF11                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Components\HARDWARE\Rs485.c -D ZIGBEEPRO -D     #
#                          ZTOOL_P1 -D MT_SYS_FUNC -D xMT_ZDO_FUNC -D         #
#                          LCD_SUPPORTED=DEBUG -D NV_RESTORE -lC              #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\Coor #
#                          dinator\List\ -lA D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC #
#                          2530\NODERED-LED¿ØÖÆ\Projects\zstack\Samples\Sampl #
#                          eApp\CC2530DB\Coordinator\List\ --diag_suppress    #
#                          Pe001,Pa010 -o D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC253 #
#                          0\NODERED-LED¿ØÖÆ\Projects\zstack\Samples\SampleAp #
#                          p\CC2530DB\Coordinator\Obj\ -e --debug             #
#                          --core=plain --dptr=16,1 --data_model=large        #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½ #
#                          Ì³Ì\CC2530\NODERED-LED¿ØÖÆ\Projects\zstack\Samples #
#                          \SampleApp\CC2530DB\ -I D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½ #
#                          Ì³Ì\CC2530\NODERED-LED¿ØÖÆ\Projects\zstack\Samples #
#                          \SampleApp\CC2530DB\..\SOURCE\ -I                  #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\ZMAIN\TI2530DB\ -I D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½ #
#                          Ì³Ì\CC2530\NODERED-LED¿ØÖÆ\Projects\zstack\Samples #
#                          \SampleApp\CC2530DB\..\..\..\..\..\COMPONENTS\MT\  #
#                          -I D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LE #
#                          D¿ØÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\. #
#                          .\..\..\..\..\COMPONENTS\HAL\INCLUDE\ -I           #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\HAL\TARGET\CC2530EB\ -I      #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\OSAL\MCU\CCSOC\ -I           #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\OSAL\INCLUDE\ -I             #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\STACK\AF\ -I                 #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\STACK\NWK\ -I                #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\STACK\SEC\ -I                #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\STACK\SAPI\ -I               #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\STACK\SYS\ -I                #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\STACK\ZDO\ -I                #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\ZMAC\F8W\ -I                 #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\ZMAC\ -I                     #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\SERVICES\SADDR\ -I           #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\SERVICES\SDATA\ -I           #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\MAC\INCLUDE\ -I              #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\MAC\HIGH_LEVEL\ -I           #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\ -I      #
#                          D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\SINGLE_C #
#                          HIP\ -I D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODER #
#                          ED-LED¿ØÖÆ\Projects\zstack\Samples\SampleApp\CC253 #
#                          0DB\..\..\..\..\..\COMPONENTS\HARDWARE\ -Ohz       #
#    List file          =  D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\Coor #
#                          dinator\List\Rs485.lst                             #
#    Object file        =  D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿Ø #
#                          ÖÆ\Projects\zstack\Samples\SampleApp\CC2530DB\Coor #
#                          dinator\Obj\Rs485.r51                              #
#                                                                             #
#                                                                             #
###############################################################################

D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿ØÖÆ\Components\HARDWARE\Rs485.c
      1          #include "stdlib.h"
      2          #include "string.h"
      3          #include "stdio.h"
      4          #include "Rs485.h"

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf4
   \   unsigned char volatile __sfr P1SEL
   \                     P1SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1

  #ifndef __DELAY_H
                  ^
"D:\×ÊÁÏ\°Ë³Ç-V2\·ä³²\ÐÂ±à½Ì³Ì\CC2530\NODERED-LED¿ØÖÆ\Components\HARDWARE\delay.h",1  Warning[Pa050]: 
          non-native end of line sequence detected (this diagnostic is only
          issued once)
      5          #include "usart.h"
      6          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
      7          unsigned char  Send_Data[Send_REC_LEN];         //·¢ËÍ»º³å,×î´óSend_REC_LEN¸ö×Ö½Ú
   \                     Send_Data:
   \   000000                DS 200
   \   0000C8                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
      8          unsigned char  Receive_Data[Receive_REC_LEN];   //½ÓÊÕ»º³å,×î´óSend_REC_LEN¸ö×Ö½Ú
   \                     Receive_Data:
   \   000000                DS 200
   \   0000C8                REQUIRE __INIT_XDATA_Z
      9          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     10          Send_Stack Tx_Stack;				//485·¢ËÍÊý¾Ý½á¹¹Ìå
   \                     Tx_Stack:
   \   000000                DS 218
   \   0000DA                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     11          Receive_Stack Rx_Stack;				//485½ÓÊÕÊý¾Ý½á¹¹Ìå
   \                     Rx_Stack:
   \   000000                DS 218
   \   0000DA                REQUIRE __INIT_XDATA_Z
     12          
     13          //==========================================================
     14          //	º¯ÊýÃû³Æ£º	Rs485_Init()
     15          //
     16          //	º¯Êý¹¦ÄÜ£º	³õÊ¼»¯485
     17          //
     18          //	Èë¿Ú²ÎÊý£º	ÎÞ
     19          //
     20          //	·µ»Ø²ÎÊý£º	ÎÞ
     21          //
     22          //	ËµÃ÷£º		
     23          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     24          void Rs485_Init(void)
   \                     Rs485_Init:
     25          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
     26              P1SEL &= ~0x80;     //ÉèÖÃP1.3ÎªÆÕÍ¨IO¿Ú  
   \   000004   53F47F       ANL     0xf4,#0x7f
     27              P1DIR |= 0x08;      // P1.3¶¨ÒåÎªÊä³ö
   \   000007   43FE08       ORL     0xfe,#0x8
     28              RS485_RX_EN();      //³õÊ¼»¯Îª½ÓÊÕÄ£Ê½
   \   00000A   C293         CLR     0x90.3
     29          
     30              Rx_Stack_Init();	//³õÊ¼»¯½ÓÊÕ½á¹¹Ìå
   \   00000C                ; Setup parameters for call to function Rx_Stack_Init
   \   00000C   12....       LCALL   ??Rx_Stack_Init?relay
     31              Tx_Stack_Init();	//³õÊ¼»¯·¢ËÍ½á¹¹Ìå
   \   00000F                ; Setup parameters for call to function Tx_Stack_Init
   \   00000F   12....       LCALL   ??Tx_Stack_Init?relay
     32          }
   \   000012                REQUIRE ?Subroutine0
   \   000012                REQUIRE P1SEL
   \   000012                REQUIRE P1DIR
   \   000012                REQUIRE _A_P1
   \   000012                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
     33          
     34          //==========================================================
     35          //	º¯ÊýÃû³Æ£º	Tx_Stack_Init
     36          //
     37          //	º¯Êý¹¦ÄÜ£º	RFIDÄ£¿éÉÏ·¢Êý¾Ý½á¹¹Ìå³õÊ¼»¯
     38          //
     39          //	Èë¿Ú²ÎÊý£º	ÎÞ
     40          //              
     41          //	·µ»Ø²ÎÊý£º	ÎÞ
     42          //
     43          //	ËµÃ÷£º		
     44          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     45          void Tx_Stack_Init(void)
   \                     Tx_Stack_Init:
     46          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
     47            Tx_Stack.Head = 0xE1E2E3E4;			//Ö¡Í·
   \   000005   90....       MOV     DPTR,#__Constant_e1e2e3e4
   \   000008   12....       LCALL   ?XLOAD_R2345
   \   00000B   90....       MOV     DPTR,#Tx_Stack
   \   00000E   12....       LCALL   ?XSTORE_R2345
     48            Tx_Stack.Pack_Num = 0x00;			//°üÐòºÅ
   \   000011   90....       MOV     DPTR,#Tx_Stack + 4
   \   000014   12....       LCALL   ?Subroutine4 & 0xFFFF
     49            Tx_Stack.Src_Adr = 0x0000;			//Ô´µØÖ·
     50            Tx_Stack.Dst_Adr = 0x0000;			//Ä¿µÄµØÖ·
     51            Tx_Stack.State = 0x0000;			//×´Ì¬Âë
     52            Tx_Stack.Data_Len = 0x00;			//Êý¾Ý³¤¶È
     53            memset(Tx_Stack.Data, 0, sizeof(Tx_Stack.Data));//Êý¾ÝÊý×éÈ«²¿Çå¿Õ
   \                     ??CrossCallReturnLabel_3:
   \   000017   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001A   7C00         MOV     R4,#0x0
   \   00001C   7D00         MOV     R5,#0x0
   \   00001E   7A..         MOV     R2,#(Tx_Stack + 12) & 0xff
   \   000020   7B..         MOV     R3,#((Tx_Stack + 12) >> 8) & 0xff
   \   000022   12....       LCALL   ??memset?relay
   \   000025   7402         MOV     A,#0x2
   \   000027   12....       LCALL   ?DEALLOC_XSTACK8
     54            Tx_Stack.CrcCheck = 0x0000;		        //CRCÐ£ÑéÂë
   \   00002A   90....       MOV     DPTR,#Tx_Stack + 212
   \   00002D   E4           CLR     A
   \   00002E   F0           MOVX    @DPTR,A
   \   00002F   A3           INC     DPTR
   \   000030   F0           MOVX    @DPTR,A
     55            Tx_Stack.Tail = 0xEAEBECED;			//Ö¡Î²
   \   000031   90....       MOV     DPTR,#__Constant_eaebeced
   \   000034   12....       LCALL   ?XLOAD_R2345
   \   000037   90....       MOV     DPTR,#Tx_Stack + 214
   \   00003A                REQUIRE ?Subroutine1
   \   00003A                ; // Fall through to label ?Subroutine1
     56          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   12....       LCALL   ?XSTORE_R2345
   \   000003                REQUIRE ??Subroutine9_0
   \   000003                ; // Fall through to label ??Subroutine9_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine9_0:
   \   000000   7F02         MOV     R7,#0x2
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   E4           CLR     A
   \   000001   F0           MOVX    @DPTR,A
   \   000002   A3           INC     DPTR
   \   000003   F0           MOVX    @DPTR,A
   \   000004   A3           INC     DPTR
   \   000005   F0           MOVX    @DPTR,A
   \   000006   A3           INC     DPTR
   \   000007   F0           MOVX    @DPTR,A
   \   000008   A3           INC     DPTR
   \   000009   F0           MOVX    @DPTR,A
   \   00000A   A3           INC     DPTR
   \   00000B   F0           MOVX    @DPTR,A
   \   00000C   A3           INC     DPTR
   \   00000D   F0           MOVX    @DPTR,A
   \   00000E   A3           INC     DPTR
   \   00000F   F0           MOVX    @DPTR,A
   \   000010                ; Setup parameters for call to function memset
   \   000010                ; Setup parameters for call to function memset
   \   000010   75..C8       MOV     ?V0 + 0,#-0x38
   \   000013   F5..         MOV     ?V0 + 1,A
   \   000015   78..         MOV     R0,#?V0 + 0
   \   000017   22           RET
     57          
     58          //==========================================================
     59          //	º¯ÊýÃû³Æ£º	Rx_Stack_Init
     60          //
     61          //	º¯Êý¹¦ÄÜ£º	ÉÏÎ»»úÏÂ·¢Êý¾Ý½á¹¹Ìå³õÊ¼»¯
     62          //
     63          //	Èë¿Ú²ÎÊý£º	ÎÞ
     64          //              
     65          //	·µ»Ø²ÎÊý£º	ÎÞ
     66          //
     67          //	ËµÃ÷£º		
     68          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     69          void Rx_Stack_Init(void)
   \                     Rx_Stack_Init:
     70          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
     71            Rx_Stack.Head = 0xE1E2E3E4;		        //Ö¡Í·
   \   000005   90....       MOV     DPTR,#__Constant_e1e2e3e4
   \   000008   12....       LCALL   ?XLOAD_R2345
   \   00000B   90....       MOV     DPTR,#Rx_Stack
   \   00000E   12....       LCALL   ?XSTORE_R2345
     72            Rx_Stack.Pack_Num = 0x00;		        //°üÐòºÅ
   \   000011   90....       MOV     DPTR,#Rx_Stack + 4
   \   000014   12....       LCALL   ?Subroutine4 & 0xFFFF
     73            Rx_Stack.Src_Adr = 0x0000;			//Ô´µØÖ·
     74            Rx_Stack.Dst_Adr = 0x0000;			//Ä¿µÄµØÖ·
     75            Rx_Stack.Command = 0x0000;			//ÃüÁîÂë
     76            Rx_Stack.Data_Len = 0x00;			//Êý¾Ý³¤¶È						
     77            memset(Rx_Stack.Data, 0, sizeof(Rx_Stack.Data));//Êý¾ÝÊý×éÈ«²¿Çå¿Õ
   \                     ??CrossCallReturnLabel_4:
   \   000017   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001A   7C00         MOV     R4,#0x0
   \   00001C   7D00         MOV     R5,#0x0
   \   00001E   7A..         MOV     R2,#(Rx_Stack + 12) & 0xff
   \   000020   7B..         MOV     R3,#((Rx_Stack + 12) >> 8) & 0xff
   \   000022   12....       LCALL   ??memset?relay
   \   000025   7402         MOV     A,#0x2
   \   000027   12....       LCALL   ?DEALLOC_XSTACK8
     78            Rx_Stack.CrcCheck = 0x0000;			//CRCÐ£ÑéÂë
   \   00002A   90....       MOV     DPTR,#Rx_Stack + 212
   \   00002D   E4           CLR     A
   \   00002E   F0           MOVX    @DPTR,A
   \   00002F   A3           INC     DPTR
   \   000030   F0           MOVX    @DPTR,A
     79            Rx_Stack.Tail = 0xEAEBECED;			//Ö¡Î²
   \   000031   90....       MOV     DPTR,#__Constant_eaebeced
   \   000034   12....       LCALL   ?XLOAD_R2345
   \   000037   90....       MOV     DPTR,#Rx_Stack + 214
   \   00003A   80..         SJMP    ?Subroutine1
     80          }
     81          
     82          //==========================================================
     83          //	º¯ÊýÃû³Æ£º	Rs485_Send()
     84          //
     85          //	º¯Êý¹¦ÄÜ£º	·¢ËÍÊý¾Ýµ½485×ÜÏßÉÏ
     86          //
     87          //	Èë¿Ú²ÎÊý£º	SrcAdr:Ô´µØÖ·
     88          //			DstAdr:Ä¿µÄµØÖ·
     89          //			Cmd		:ÃüÁîÂë
     90          //			Len		:Êý¾Ý³¤¶È
     91          //			*pData:Êý¾Ý
     92          //
     93          //	·µ»Ø²ÎÊý£º	ÎÞ
     94          //
     95          //	ËµÃ÷£º		
     96          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     97          void Rs485_Send(uint16_t SrcAdr,uint16_t DstAdr,uint16_t Cmd,uint8_t Len,uint8_t *pData)
   \                     Rs485_Send:
     98          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
   \   000007   740C         MOV     A,#0xc
   \   000009   12....       LCALL   ?XSTACK_DISP0_8
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   F5..         MOV     ?V0 + 2,A
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   F5..         MOV     ?V0 + 3,A
   \   000013   740E         MOV     A,#0xe
   \   000015   12....       LCALL   ?XSTACK_DISP0_8
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F8           MOV     R0,A
   \   00001A   A3           INC     DPTR
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   F9           MOV     R1,A
     99            static uint16_t i = 0;	            //Çå¿ÕÊý×éÊ±ForÑ­»·Ê¹ÓÃ	
    100            
    101            for(i=0;i<4;i++)
   \   00001D   90....       MOV     DPTR,#??i
   \   000020   E4           CLR     A
   \   000021   F0           MOVX    @DPTR,A
   \   000022   A3           INC     DPTR
   \   000023   F0           MOVX    @DPTR,A
    102            {
    103               Send_Data[i] = (0xE1+i);		    //Ö¡Í·
   \                     ??Rs485_Send_0:
   \   000024   90....       MOV     DPTR,#??i
   \   000027   E0           MOVX    A,@DPTR
   \   000028   24E1         ADD     A,#-0x1f
   \   00002A   C0E0         PUSH    A
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   24..         ADD     A,#Send_Data & 0xff
   \   00002F   FE           MOV     R6,A
   \   000030   A3           INC     DPTR
   \   000031   E0           MOVX    A,@DPTR
   \   000032   34..         ADDC    A,#(Send_Data >> 8) & 0xff
   \   000034   FF           MOV     R7,A
   \   000035   8E82         MOV     DPL,R6
   \   000037   8F83         MOV     DPH,R7
   \   000039   D0E0         POP     A
   \   00003B   12....       LCALL   ?Subroutine3 & 0xFFFF
    104            }
   \                     ??CrossCallReturnLabel_0:
   \   00003E   90....       MOV     DPTR,#??i
   \   000041   C3           CLR     C
   \   000042   E0           MOVX    A,@DPTR
   \   000043   9404         SUBB    A,#0x4
   \   000045   A3           INC     DPTR
   \   000046   E0           MOVX    A,@DPTR
   \   000047   9400         SUBB    A,#0x0
   \   000049   40D9         JC      ??Rs485_Send_0
    105          
    106            if(Tx_Stack.Pack_Num>=255)
   \   00004B   90....       MOV     DPTR,#Tx_Stack + 4
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   F4           CPL     A
   \   000050   7002         JNZ     ??Rs485_Send_1
    107            {
    108               Tx_Stack.Pack_Num = 0;	
   \   000052   E4           CLR     A
   \   000053   F0           MOVX    @DPTR,A
    109            }
    110            Send_Data[4] = Tx_Stack.Pack_Num;	    //°üÐòºÅ	
   \                     ??Rs485_Send_1:
   \   000054   E0           MOVX    A,@DPTR
   \   000055   90....       MOV     DPTR,#Send_Data + 4
   \   000058   F0           MOVX    @DPTR,A
    111            Tx_Stack.Pack_Num++;
   \   000059   90....       MOV     DPTR,#Tx_Stack + 4
   \   00005C   04           INC     A
   \   00005D   F0           MOVX    @DPTR,A
    112            Send_Data[5] = SrcAdr>>8;
   \   00005E   EB           MOV     A,R3
   \   00005F   90....       MOV     DPTR,#Send_Data + 5
   \   000062   F0           MOVX    @DPTR,A
    113            Send_Data[6] = SrcAdr;		    //Ô´µØÖ·
   \   000063   EA           MOV     A,R2
   \   000064   A3           INC     DPTR
   \   000065   F0           MOVX    @DPTR,A
    114            Send_Data[7] = DstAdr>>8;
   \   000066   ED           MOV     A,R5
   \   000067   A3           INC     DPTR
   \   000068   F0           MOVX    @DPTR,A
    115            Send_Data[8] = DstAdr;		    //Ä¿µÄµØÖ·
   \   000069   EC           MOV     A,R4
   \   00006A   A3           INC     DPTR
   \   00006B   F0           MOVX    @DPTR,A
    116            Send_Data[9] = Cmd>>8;
   \   00006C   E5..         MOV     A,?V0 + 3
   \   00006E   A3           INC     DPTR
   \   00006F   F0           MOVX    @DPTR,A
    117            Send_Data[10] = Cmd;			    //ÃüÁîÂë
   \   000070   E5..         MOV     A,?V0 + 2
   \   000072   A3           INC     DPTR
   \   000073   F0           MOVX    @DPTR,A
    118            Send_Data[11] = Len;			    //Êý¾Ý³¤¶È
   \   000074   E5..         MOV     A,?V0 + 0
   \   000076   A3           INC     DPTR
   \   000077   F0           MOVX    @DPTR,A
    119            for(i=12;i<(Len+12);i++)
   \   000078   90....       MOV     DPTR,#??i
   \   00007B   740C         MOV     A,#0xc
   \   00007D   F0           MOVX    @DPTR,A
   \   00007E   A3           INC     DPTR
   \   00007F   E4           CLR     A
   \   000080   F0           MOVX    @DPTR,A
   \   000081   85..82       MOV     DPL,?V0 + 0
   \   000084   AE82         MOV     R6,DPL
   \   000086   EE           MOV     A,R6
   \   000087   240C         ADD     A,#0xc
   \   000089   FC           MOV     R4,A
   \   00008A   E4           CLR     A
   \   00008B   3400         ADDC    A,#0x0
   \   00008D   FD           MOV     R5,A
   \   00008E   8030         SJMP    ??CrossCallReturnLabel_1
    120            {
    121                Send_Data[i] = pData[i-12];	    //Êý¾Ý
   \                     ??Rs485_Send_2:
   \   000090   90....       MOV     DPTR,#??i
   \   000093   E0           MOVX    A,@DPTR
   \   000094   FA           MOV     R2,A
   \   000095   A3           INC     DPTR
   \   000096   E0           MOVX    A,@DPTR
   \   000097   FB           MOV     R3,A
   \   000098   E8           MOV     A,R0
   \   000099   2A           ADD     A,R2
   \   00009A   FA           MOV     R2,A
   \   00009B   E9           MOV     A,R1
   \   00009C   3B           ADDC    A,R3
   \   00009D   FB           MOV     R3,A
   \   00009E   EA           MOV     A,R2
   \   00009F   24F4         ADD     A,#-0xc
   \   0000A1   F582         MOV     DPL,A
   \   0000A3   EB           MOV     A,R3
   \   0000A4   34FF         ADDC    A,#-0x1
   \   0000A6   F583         MOV     DPH,A
   \   0000A8   E0           MOVX    A,@DPTR
   \   0000A9   C0E0         PUSH    A
   \   0000AB   90....       MOV     DPTR,#??i
   \   0000AE   E0           MOVX    A,@DPTR
   \   0000AF   24..         ADD     A,#Send_Data & 0xff
   \   0000B1   FA           MOV     R2,A
   \   0000B2   A3           INC     DPTR
   \   0000B3   E0           MOVX    A,@DPTR
   \   0000B4   34..         ADDC    A,#(Send_Data >> 8) & 0xff
   \   0000B6   FB           MOV     R3,A
   \   0000B7   8A82         MOV     DPL,R2
   \   0000B9   8B83         MOV     DPH,R3
   \   0000BB   D0E0         POP     A
   \   0000BD   12....       LCALL   ?Subroutine3 & 0xFFFF
    122            }
   \                     ??CrossCallReturnLabel_1:
   \   0000C0   90....       MOV     DPTR,#??i
   \   0000C3   C3           CLR     C
   \   0000C4   E0           MOVX    A,@DPTR
   \   0000C5   9C           SUBB    A,R4
   \   0000C6   A3           INC     DPTR
   \   0000C7   E0           MOVX    A,@DPTR
   \   0000C8   9D           SUBB    A,R5
   \   0000C9   40C5         JC      ??Rs485_Send_2
    123            Tx_Stack.CrcCheck = CRC_16(Send_Data,(12+Len));//CRCÐ£ÑéÂë
   \   0000CB                ; Setup parameters for call to function CRC_16
   \   0000CB   7A..         MOV     R2,#Send_Data & 0xff
   \   0000CD   7B..         MOV     R3,#(Send_Data >> 8) & 0xff
   \   0000CF   12....       LCALL   ??CRC_16?relay
   \   0000D2   90....       MOV     DPTR,#Tx_Stack + 212
   \   0000D5   EA           MOV     A,R2
   \   0000D6   F0           MOVX    @DPTR,A
   \   0000D7   A3           INC     DPTR
   \   0000D8   EB           MOV     A,R3
   \   0000D9   F0           MOVX    @DPTR,A
    124            Send_Data[12+Len] = Tx_Stack.CrcCheck>>8;
   \   0000DA   74..         MOV     A,#Send_Data & 0xff
   \   0000DC   2E           ADD     A,R6
   \   0000DD   F8           MOV     R0,A
   \   0000DE   74..         MOV     A,#(Send_Data >> 8) & 0xff
   \   0000E0   12....       LCALL   ?Subroutine6 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   0000E3   EB           MOV     A,R3
   \   0000E4   F0           MOVX    @DPTR,A
    125            Send_Data[13+Len] = Tx_Stack.CrcCheck;    //CRCÐ£ÑéÂë
   \   0000E5   90....       MOV     DPTR,#Tx_Stack + 212
   \   0000E8   E0           MOVX    A,@DPTR
   \   0000E9   C0E0         PUSH    A
   \   0000EB   12....       LCALL   ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   0000EE   D0E0         POP     A
   \   0000F0   F0           MOVX    @DPTR,A
    126            for(i=(14+Len);i<(18+Len);i++)
   \   0000F1   EE           MOV     A,R6
   \   0000F2   240E         ADD     A,#0xe
   \   0000F4   F8           MOV     R0,A
   \   0000F5   E4           CLR     A
   \   0000F6   3400         ADDC    A,#0x0
   \   0000F8   F9           MOV     R1,A
   \   0000F9   90....       MOV     DPTR,#??i
   \   0000FC   E8           MOV     A,R0
   \   0000FD   F0           MOVX    @DPTR,A
   \   0000FE   A3           INC     DPTR
   \   0000FF   E9           MOV     A,R1
   \   000100   F0           MOVX    @DPTR,A
   \   000101   EE           MOV     A,R6
   \   000102   2412         ADD     A,#0x12
   \   000104   FE           MOV     R6,A
   \   000105   E4           CLR     A
   \   000106   3400         ADDC    A,#0x0
   \   000108   FF           MOV     R7,A
   \   000109   801F         SJMP    ??CrossCallReturnLabel_2
    127            {
    128                Send_Data[i] = (0xEA+(i-14-Len));     //Ö¡Î²
   \                     ??Rs485_Send_3:
   \   00010B   90....       MOV     DPTR,#??i
   \   00010E   E0           MOVX    A,@DPTR
   \   00010F   24F2         ADD     A,#-0xe
   \   000111   C3           CLR     C
   \   000112   95..         SUBB    A,?V0 + 0
   \   000114   24EA         ADD     A,#-0x16
   \   000116   C0E0         PUSH    A
   \   000118   E0           MOVX    A,@DPTR
   \   000119   24..         ADD     A,#Send_Data & 0xff
   \   00011B   F8           MOV     R0,A
   \   00011C   A3           INC     DPTR
   \   00011D   E0           MOVX    A,@DPTR
   \   00011E   34..         ADDC    A,#(Send_Data >> 8) & 0xff
   \   000120   F9           MOV     R1,A
   \   000121   8882         MOV     DPL,R0
   \   000123   8983         MOV     DPH,R1
   \   000125   D0E0         POP     A
   \   000127   12....       LCALL   ?Subroutine3 & 0xFFFF
    129            }
   \                     ??CrossCallReturnLabel_2:
   \   00012A   90....       MOV     DPTR,#??i
   \   00012D   C3           CLR     C
   \   00012E   E0           MOVX    A,@DPTR
   \   00012F   9E           SUBB    A,R6
   \   000130   A3           INC     DPTR
   \   000131   E0           MOVX    A,@DPTR
   \   000132   9F           SUBB    A,R7
   \   000133   40D6         JC      ??Rs485_Send_3
    130          
    131            RS485_TX_EN();//¿ªÆô485·¢ËÍ
   \   000135   D293         SETB    0x90.3
    132            Rs485_delay_ms(5);
   \   000137                ; Setup parameters for call to function Rs485_delay_ms
   \   000137   7A05         MOV     R2,#0x5
   \   000139   7B00         MOV     R3,#0x0
   \   00013B   12....       LCALL   ??Rs485_delay_ms?relay
    133            USART1_SendString(Send_Data,(18+Len));    //485·¢ËÍÊý¾Ý
   \   00013E                ; Setup parameters for call to function USART1_SendString
   \   00013E   EE           MOV     A,R6
   \   00013F   FC           MOV     R4,A
   \   000140   EF           MOV     A,R7
   \   000141   FD           MOV     R5,A
   \   000142   7A..         MOV     R2,#Send_Data & 0xff
   \   000144   7B..         MOV     R3,#(Send_Data >> 8) & 0xff
   \   000146   12....       LCALL   ??USART1_SendString?relay
    134            Rs485_delay_ms(5);
   \   000149                ; Setup parameters for call to function Rs485_delay_ms
   \   000149   7A05         MOV     R2,#0x5
   \   00014B   7B00         MOV     R3,#0x0
   \   00014D   12....       LCALL   ??Rs485_delay_ms?relay
    135            RS485_RX_EN();//¿ªÆô485½ÓÊÕ
   \   000150   C293         CLR     0x90.3
    136          }
   \   000152                REQUIRE ?Subroutine2
   \   000152                REQUIRE _A_P1
   \   000152                ; // Fall through to label ?Subroutine2

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   7F04         MOV     R7,#0x4
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   90....       MOV     DPTR,#??i
   \   000004   12....       LCALL   ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   000007   F0           MOVX    @DPTR,A
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   E8           MOV     A,R0
   \   000001   240D         ADD     A,#0xd
   \   000003   F582         MOV     DPL,A
   \   000005   E9           MOV     A,R1
   \   000006   3400         ADDC    A,#0x0
   \   000008   F583         MOV     DPH,A
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F9           MOV     R1,A
   \   000003   E8           MOV     A,R0
   \   000004   240C         ADD     A,#0xc
   \   000006   F582         MOV     DPL,A
   \   000008   E9           MOV     A,R1
   \   000009   3400         ADDC    A,#0x0
   \   00000B   F583         MOV     DPH,A
   \   00000D   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   2401         ADD     A,#0x1
   \   000003   F0           MOVX    @DPTR,A
   \   000004   A3           INC     DPTR
   \   000005   E0           MOVX    A,@DPTR
   \   000006   3400         ADDC    A,#0x0
   \   000008   22           RET

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??i:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    137          
    138          //==========================================================
    139          //	º¯ÊýÃû³Æ£º	Rs485_Receive()
    140          //
    141          //	º¯Êý¹¦ÄÜ£º	485½ÓÊÕ
    142          //
    143          //	Èë¿Ú²ÎÊý£º	data:485Êý¾Ý
    144          //
    145          //	·µ»Ø²ÎÊý£º	ÎÞ
    146          //
    147          //	ËµÃ÷£º		
    148          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    149          void Rs485_Receive(uint8_t data)
   \                     Rs485_Receive:
    150          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    151              static uint8_t End_Flag     = 0;	//Ö¡Î²±êÖ¾Î»
    152              static uint8_t Header_Flag  = 0;	//Ö¡Í·±êÖ¾Î»
    153              static uint8_t Receive_Flag = 0;	//½ÓÊÕ±êÖ¾Î»
    154          
    155          /*
    156          *
    157          *	Ö¡Í·½ÓÊÕ
    158          *
    159          */
    160              /*Ö¡Í·1 Êý¾ÝÖ¡Í·ÖÐµÚÒ»¸ö×Ö½Ú*/
    161              if(data == 0xE1) Header_Flag = 1;
   \   000004   74E1         MOV     A,#-0x1f
   \   000006   69           XRL     A,R1
   \   000007   90....       MOV     DPTR,#??Header_Flag
   \   00000A   7004         JNZ     ??Rs485_Receive_0
   \   00000C   7401         MOV     A,#0x1
   \   00000E   8042         SJMP    ??Rs485_Receive_1
    162          
    163              /*Ö¡Í·2 Êý¾ÝÖ¡Í·ÖÐµÚ¶þ¸ö×Ö½Ú*/
    164              else if(Header_Flag == 1 && data == 0xE2) Header_Flag = 2;
   \                     ??Rs485_Receive_0:
   \   000010   E0           MOVX    A,@DPTR
   \   000011   6401         XRL     A,#0x1
   \   000013   7009         JNZ     ??Rs485_Receive_2
   \   000015   74E2         MOV     A,#-0x1e
   \   000017   69           XRL     A,R1
   \   000018   7037         JNZ     ??Rs485_Receive_3
   \   00001A   7402         MOV     A,#0x2
   \   00001C   8034         SJMP    ??Rs485_Receive_1
    165          
    166              /*Ö¡Í·3 Êý¾ÝÖ¡Í·ÖÐµÚÈý¸ö×Ö½Ú*/
    167              else if(Header_Flag == 2 && data == 0xE3) Header_Flag = 3;
   \                     ??Rs485_Receive_2:
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   6402         XRL     A,#0x2
   \   000021   7009         JNZ     ??Rs485_Receive_4
   \   000023   74E3         MOV     A,#-0x1d
   \   000025   69           XRL     A,R1
   \   000026   7029         JNZ     ??Rs485_Receive_3
   \   000028   7403         MOV     A,#0x3
   \   00002A   8026         SJMP    ??Rs485_Receive_1
    168              
    169              /*Ö¡Í·4 Êý¾ÝÖ¡Í·ÖÐµÚËÄ¸ö×Ö½Ú*/
    170              else if(Header_Flag == 3 && data == 0xE4)
   \                     ??Rs485_Receive_4:
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   6403         XRL     A,#0x3
   \   00002F   7020         JNZ     ??Rs485_Receive_3
   \   000031   74E4         MOV     A,#-0x1c
   \   000033   69           XRL     A,R1
   \   000034   701B         JNZ     ??Rs485_Receive_3
    171              {
    172                  Receive_Data[0] = 0xE1;
   \   000036   90....       MOV     DPTR,#Receive_Data
   \   000039   74E1         MOV     A,#-0x1f
   \   00003B   F0           MOVX    @DPTR,A
    173                  Receive_Data[1] = 0xE2;
   \   00003C   A3           INC     DPTR
   \   00003D   04           INC     A
   \   00003E   F0           MOVX    @DPTR,A
    174                  Receive_Data[2] = 0xE3; //Ö¡Í·½ÓÊÕÍê³É£¬´æÈëÖ¡Í·Êý¾Ý
   \   00003F   A3           INC     DPTR
   \   000040   04           INC     A
   \   000041   F0           MOVX    @DPTR,A
    175                  USART1_RX_STA = 3;      //´æ·ÅÊý¾ÝÊý×éÏÂ±êÇåÁã
   \   000042   90....       MOV     DPTR,#USART1_RX_STA
   \   000045   7403         MOV     A,#0x3
   \   000047   F0           MOVX    @DPTR,A
   \   000048   A3           INC     DPTR
   \   000049   E4           CLR     A
   \   00004A   F0           MOVX    @DPTR,A
    176                  Receive_Flag = 1;       //¿ªÊ¼½ÓÊÕÊý¾Ý±êÖ¾Î»
   \   00004B   90....       MOV     DPTR,#??Receive_Flag
   \   00004E   04           INC     A
   \   00004F   8023         SJMP    ??Rs485_Receive_5
    177              }
    178          
    179              else Header_Flag = 0;
   \                     ??Rs485_Receive_3:
   \   000051   E4           CLR     A
   \                     ??Rs485_Receive_1:
   \   000052   F0           MOVX    @DPTR,A
    180          	
    181          /*
    182          *
    183          *	Êý¾Ý+Ö¡Î²½ÓÊÕ
    184          *
    185          */
    186              if(Receive_Flag)	//Ö¡Í·½ÓÊÕÍê³É,×¼±¸½ÓÊÕÖ¡Î²
   \   000053   90....       MOV     DPTR,#??Receive_Flag
   \   000056   E0           MOVX    A,@DPTR
   \   000057   607C         JZ      ??Rs485_Receive_6
    187              {
    188                  if(USART1_RX_STA>=(Receive_REC_LEN-1))
   \   000059   90....       MOV     DPTR,#USART1_RX_STA
   \   00005C   C3           CLR     C
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   94C7         SUBB    A,#-0x39
   \   000060   A3           INC     DPTR
   \   000061   E0           MOVX    A,@DPTR
   \   000062   9400         SUBB    A,#0x0
   \   000064   400F         JC      ??Rs485_Receive_7
    189                  {
    190                      End_Flag = 0;
   \   000066   90....       MOV     DPTR,#??End_Flag
   \   000069   E4           CLR     A
   \   00006A   F0           MOVX    @DPTR,A
    191                      Receive_Flag = 0;
   \   00006B   90....       MOV     DPTR,#??Receive_Flag
   \   00006E   F0           MOVX    @DPTR,A
    192                      USART1_RX_STA = 0;
   \   00006F   90....       MOV     DPTR,#USART1_RX_STA
   \   000072   F0           MOVX    @DPTR,A
   \   000073   A3           INC     DPTR
   \                     ??Rs485_Receive_5:
   \   000074   F0           MOVX    @DPTR,A
    193                  }
    194          
    195                  Receive_Data[USART1_RX_STA++] = data;	//Êý¾Ý½ÓÊÕ
   \                     ??Rs485_Receive_7:
   \   000075   90....       MOV     DPTR,#USART1_RX_STA
   \   000078   E0           MOVX    A,@DPTR
   \   000079   24..         ADD     A,#Receive_Data & 0xff
   \   00007B   FA           MOV     R2,A
   \   00007C   A3           INC     DPTR
   \   00007D   E0           MOVX    A,@DPTR
   \   00007E   34..         ADDC    A,#(Receive_Data >> 8) & 0xff
   \   000080   FB           MOV     R3,A
   \   000081   8A82         MOV     DPL,R2
   \   000083   8B83         MOV     DPH,R3
   \   000085   E9           MOV     A,R1
   \   000086   F0           MOVX    @DPTR,A
   \   000087   90....       MOV     DPTR,#USART1_RX_STA
   \   00008A   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   00008D   F0           MOVX    @DPTR,A
    196          
    197                  /*Ö¡Î²1 Êý¾ÝÖ¡Î²ÖÐµÚÒ»¸ö×Ö½Ú*/
    198                  if(data == 0xEA)	End_Flag = 1;
   \   00008E   74EA         MOV     A,#-0x16
   \   000090   69           XRL     A,R1
   \   000091   90....       MOV     DPTR,#??End_Flag
   \   000094   7004         JNZ     ??Rs485_Receive_8
   \   000096   7401         MOV     A,#0x1
   \   000098   803A         SJMP    ??Rs485_Receive_9
    199          
    200                  /*Ö¡Î²2  Êý¾ÝÖ¡Î²ÖÐµÚ¶þ¸ö×Ö½Ú*/
    201                  else if(End_Flag == 1 && data == 0xEB)	End_Flag = 2;
   \                     ??Rs485_Receive_8:
   \   00009A   E0           MOVX    A,@DPTR
   \   00009B   6401         XRL     A,#0x1
   \   00009D   7009         JNZ     ??Rs485_Receive_10
   \   00009F   74EB         MOV     A,#-0x15
   \   0000A1   69           XRL     A,R1
   \   0000A2   702F         JNZ     ??Rs485_Receive_11
   \   0000A4   7402         MOV     A,#0x2
   \   0000A6   802C         SJMP    ??Rs485_Receive_9
    202          
    203                  /*Ö¡Î²3  Êý¾ÝÖ¡Î²ÖÐµÚÈý¸ö×Ö½Ú*/
    204                  else if(End_Flag == 2 && data == 0xEC)	End_Flag = 3;
   \                     ??Rs485_Receive_10:
   \   0000A8   E0           MOVX    A,@DPTR
   \   0000A9   6402         XRL     A,#0x2
   \   0000AB   7009         JNZ     ??Rs485_Receive_12
   \   0000AD   74EC         MOV     A,#-0x14
   \   0000AF   69           XRL     A,R1
   \   0000B0   7021         JNZ     ??Rs485_Receive_11
   \   0000B2   7403         MOV     A,#0x3
   \   0000B4   801E         SJMP    ??Rs485_Receive_9
    205          
    206                  /*Ö¡Î²4  Êý¾ÝÖ¡Î²ÖÐµÚËÄ¸ö×Ö½Ú*/
    207                  else if(End_Flag == 3 && data == 0xED)
   \                     ??Rs485_Receive_12:
   \   0000B6   E0           MOVX    A,@DPTR
   \   0000B7   6403         XRL     A,#0x3
   \   0000B9   7018         JNZ     ??Rs485_Receive_11
   \   0000BB   74ED         MOV     A,#-0x13
   \   0000BD   69           XRL     A,R1
   \   0000BE   7013         JNZ     ??Rs485_Receive_11
    208                  {
    209                      USART1_RX_STA = 0x8000;	//½ÓÊÕÍê³É
   \   0000C0   90....       MOV     DPTR,#USART1_RX_STA
   \   0000C3   E4           CLR     A
   \   0000C4   F0           MOVX    @DPTR,A
   \   0000C5   A3           INC     DPTR
   \   0000C6   7480         MOV     A,#-0x80
   \   0000C8   F0           MOVX    @DPTR,A
    210                      Receive_Flag = 0;
   \   0000C9   90....       MOV     DPTR,#??Receive_Flag
   \   0000CC   E4           CLR     A
   \   0000CD   F0           MOVX    @DPTR,A
    211                      End_Flag = 0;
   \   0000CE   90....       MOV     DPTR,#??End_Flag
   \   0000D1   8001         SJMP    ??Rs485_Receive_9
    212                  }
    213          
    214                  /*»¹Ã»½ÓÊÕµ½Ö¡Î²*/
    215                  else End_Flag = 0;
   \                     ??Rs485_Receive_11:
   \   0000D3   E4           CLR     A
   \                     ??Rs485_Receive_9:
   \   0000D4   F0           MOVX    @DPTR,A
    216              }
    217          }
   \                     ??Rs485_Receive_6:
   \   0000D5   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   12....       LCALL   ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_14:
   \   000003   22           RET

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??End_Flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??Header_Flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??Receive_Flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    218          
    219          //==========================================================
    220          //	º¯ÊýÃû³Æ£º	DataHandling_485()
    221          //
    222          //	º¯Êý¹¦ÄÜ£º	485Êý¾Ý´¦Àíº¯Êý
    223          //
    224          //	Èë¿Ú²ÎÊý£º	DesAddr	:Ä¿µÄµØÖ·
    225          //              
    226          //	·µ»Ø²ÎÊý£º	0:Êý¾Ý½ÓÊÕÍê³É
    227          //			1:Êý¾Ý½ÓÊÕ´íÎó
    228          //
    229          //	ËµÃ÷£º		
    230          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    231          uint8_t DataHandling_485(uint16_t DesAddr)
   \                     DataHandling_485:
    232          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    233            static uint16_t i = 0;
    234            static uint8_t Return_Value = 0;      //·µ»ØÖµ
    235            static uint16_t Crc16Check = 0;	//´æ·ÅCRCÐ£ÑéÊý¾Ý
    236          
    237            if(USART1_RX_STA == 0x8000)
   \   000005   90....       MOV     DPTR,#USART1_RX_STA
   \   000008   E0           MOVX    A,@DPTR
   \   000009   7004         JNZ     ??DataHandling_485_0
   \   00000B   A3           INC     DPTR
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6480         XRL     A,#0x80
   \                     ??DataHandling_485_0:
   \   00000F   90....       MOV     DPTR,#??Return_Value
   \   000012   6003         JZ      $+5
   \   000014   02....       LJMP    ??DataHandling_485_1 & 0xFFFF
    238            {
    239                Return_Value = 0;
   \   000017   E4           CLR     A
   \   000018   F0           MOVX    @DPTR,A
    240                if((Receive_Data[7]*256+Receive_Data[8]) == DesAddr)//¶Ô±ÈÔ´µØÖ·ÊÇÏëÒªµÄÊý¾Ý£¬È«²¿½ÓÊÕÏÂÀ´
   \   000019   90....       MOV     DPTR,#Receive_Data + 7
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F9           MOV     R1,A
   \   00001E   A3           INC     DPTR
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F8           MOV     R0,A
   \   000021   EA           MOV     A,R2
   \   000022   68           XRL     A,R0
   \   000023   7002         JNZ     ??DataHandling_485_2
   \   000025   EB           MOV     A,R3
   \   000026   69           XRL     A,R1
   \                     ??DataHandling_485_2:
   \   000027   6003         JZ      $+5
   \   000029   02....       LJMP    ??DataHandling_485_3 & 0xFFFF
    241                {
    242                    /*°üÐòºÅ*/
    243                    Rx_Stack.Pack_Num = Receive_Data[4];
   \   00002C   90....       MOV     DPTR,#Receive_Data + 4
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   90....       MOV     DPTR,#Rx_Stack + 4
   \   000033   F0           MOVX    @DPTR,A
    244            
    245                    /*Ô´µØÖ·*/
    246                    Rx_Stack.Src_Adr = Receive_Data[5]*256+Receive_Data[6];
   \   000034   90....       MOV     DPTR,#Receive_Data + 5
   \   000037   E0           MOVX    A,@DPTR
   \   000038   FB           MOV     R3,A
   \   000039   A3           INC     DPTR
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   90....       MOV     DPTR,#Rx_Stack + 5
   \   00003E   F0           MOVX    @DPTR,A
   \   00003F   A3           INC     DPTR
   \   000040   EB           MOV     A,R3
   \   000041   F0           MOVX    @DPTR,A
    247            
    248                    /*Ä¿µÄµØÖ·*/
    249                    Rx_Stack.Dst_Adr = Receive_Data[7]*256+Receive_Data[8];
   \   000042   A3           INC     DPTR
   \   000043   E8           MOV     A,R0
   \   000044   F0           MOVX    @DPTR,A
   \   000045   A3           INC     DPTR
   \   000046   E9           MOV     A,R1
   \   000047   F0           MOVX    @DPTR,A
    250            
    251                    /*ÃüÁîÂë*/
    252                    Rx_Stack.Command = Receive_Data[9]*256+Receive_Data[10];
   \   000048   90....       MOV     DPTR,#Receive_Data + 9
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   F9           MOV     R1,A
   \   00004D   A3           INC     DPTR
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   90....       MOV     DPTR,#Rx_Stack + 9
   \   000052   F0           MOVX    @DPTR,A
   \   000053   A3           INC     DPTR
   \   000054   E9           MOV     A,R1
   \   000055   F0           MOVX    @DPTR,A
    253            
    254                    /*Êý¾Ý³¤¶È*/
    255                    Rx_Stack.Data_Len = Receive_Data[11];
   \   000056   90....       MOV     DPTR,#Receive_Data + 11
   \   000059   E0           MOVX    A,@DPTR
   \   00005A   90....       MOV     DPTR,#Rx_Stack + 11
   \   00005D   F0           MOVX    @DPTR,A
    256            
    257                    /*Êý¾Ý*/
    258                    for(i=12;i<(Rx_Stack.Data_Len+12);i++)
   \   00005E   90....       MOV     DPTR,#??i_1
   \   000061   740C         MOV     A,#0xc
   \   000063   F0           MOVX    @DPTR,A
   \   000064   A3           INC     DPTR
   \   000065   E4           CLR     A
   \   000066   802C         SJMP    ??CrossCallReturnLabel_6
    259                    {
    260                        Rx_Stack.Data[(i-12)] = Receive_Data[i];
   \                     ??DataHandling_485_4:
   \   000068   90....       MOV     DPTR,#??i_1
   \   00006B   E0           MOVX    A,@DPTR
   \   00006C   24..         ADD     A,#Receive_Data & 0xff
   \   00006E   F8           MOV     R0,A
   \   00006F   A3           INC     DPTR
   \   000070   E0           MOVX    A,@DPTR
   \   000071   34..         ADDC    A,#(Receive_Data >> 8) & 0xff
   \   000073   F9           MOV     R1,A
   \   000074   8882         MOV     DPL,R0
   \   000076   8983         MOV     DPH,R1
   \   000078   E0           MOVX    A,@DPTR
   \   000079   C0E0         PUSH    A
   \   00007B   90....       MOV     DPTR,#??i_1
   \   00007E   E0           MOVX    A,@DPTR
   \   00007F   24..         ADD     A,#Rx_Stack & 0xff
   \   000081   F8           MOV     R0,A
   \   000082   A3           INC     DPTR
   \   000083   E0           MOVX    A,@DPTR
   \   000084   34..         ADDC    A,#(Rx_Stack >> 8) & 0xff
   \   000086   F9           MOV     R1,A
   \   000087   8882         MOV     DPL,R0
   \   000089   8983         MOV     DPH,R1
   \   00008B   D0E0         POP     A
   \   00008D   F0           MOVX    @DPTR,A
    261                    }
   \   00008E   90....       MOV     DPTR,#??i_1
   \   000091   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   000094   F0           MOVX    @DPTR,A
   \   000095   90....       MOV     DPTR,#Rx_Stack + 11
   \   000098   E0           MOVX    A,@DPTR
   \   000099   F8           MOV     R0,A
   \   00009A   240C         ADD     A,#0xc
   \   00009C   FC           MOV     R4,A
   \   00009D   E4           CLR     A
   \   00009E   3400         ADDC    A,#0x0
   \   0000A0   FD           MOV     R5,A
   \   0000A1   90....       MOV     DPTR,#??i_1
   \   0000A4   E0           MOVX    A,@DPTR
   \   0000A5   9C           SUBB    A,R4
   \   0000A6   A3           INC     DPTR
   \   0000A7   E0           MOVX    A,@DPTR
   \   0000A8   9D           SUBB    A,R5
   \   0000A9   40BD         JC      ??DataHandling_485_4
    262            
    263                    /*CRCÐ£ÑéÂë¸ß°ËÎ»*/
    264                    Rx_Stack.CrcCheck = Receive_Data[(12+Rx_Stack.Data_Len)]*256;
   \   0000AB   74..         MOV     A,#Receive_Data & 0xff
   \   0000AD   28           ADD     A,R0
   \   0000AE   F8           MOV     R0,A
   \   0000AF   74..         MOV     A,#(Receive_Data >> 8) & 0xff
   \   0000B1   12....       LCALL   ?Subroutine6 & 0xFFFF
   \                     ??CrossCallReturnLabel_10:
   \   0000B4   E0           MOVX    A,@DPTR
   \   0000B5   FB           MOV     R3,A
   \   0000B6   90....       MOV     DPTR,#Rx_Stack + 212
   \   0000B9   E4           CLR     A
   \   0000BA   F0           MOVX    @DPTR,A
   \   0000BB   A3           INC     DPTR
   \   0000BC   EB           MOV     A,R3
   \   0000BD   F0           MOVX    @DPTR,A
    265            
    266                    /*CRCÐ£ÑéÂëµÍ°ËÎ»*/
    267                    Rx_Stack.CrcCheck += Receive_Data[(13+Rx_Stack.Data_Len)];
   \   0000BE   12....       LCALL   ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   0000C1   E0           MOVX    A,@DPTR
   \   0000C2   90....       MOV     DPTR,#Rx_Stack + 212
   \   0000C5   F0           MOVX    @DPTR,A
    268                    Crc16Check = CRC_16(Receive_Data,(12+Rx_Stack.Data_Len));
   \   0000C6                ; Setup parameters for call to function CRC_16
   \   0000C6   7A..         MOV     R2,#Receive_Data & 0xff
   \   0000C8   7B..         MOV     R3,#(Receive_Data >> 8) & 0xff
   \   0000CA   12....       LCALL   ??CRC_16?relay
   \   0000CD   90....       MOV     DPTR,#??Crc16Check
   \   0000D0   EA           MOV     A,R2
   \   0000D1   F0           MOVX    @DPTR,A
   \   0000D2   A3           INC     DPTR
   \   0000D3   EB           MOV     A,R3
   \   0000D4   F0           MOVX    @DPTR,A
    269                    if(Crc16Check != Rx_Stack.CrcCheck)
   \   0000D5   90....       MOV     DPTR,#??Crc16Check
   \   0000D8   E0           MOVX    A,@DPTR
   \   0000D9   F8           MOV     R0,A
   \   0000DA   A3           INC     DPTR
   \   0000DB   E0           MOVX    A,@DPTR
   \   0000DC   F9           MOV     R1,A
   \   0000DD   90....       MOV     DPTR,#Rx_Stack + 212
   \   0000E0   E0           MOVX    A,@DPTR
   \   0000E1   68           XRL     A,R0
   \   0000E2   7003         JNZ     ??DataHandling_485_5
   \   0000E4   A3           INC     DPTR
   \   0000E5   E0           MOVX    A,@DPTR
   \   0000E6   69           XRL     A,R1
   \                     ??DataHandling_485_5:
   \   0000E7   6006         JZ      ??DataHandling_485_6
    270                    {
    271                        Return_Value = 1;
   \                     ??DataHandling_485_3:
   \   0000E9   90....       MOV     DPTR,#??Return_Value
   \   0000EC   7401         MOV     A,#0x1
   \   0000EE   F0           MOVX    @DPTR,A
    272                    }
    273                }
    274                else Return_Value = 1;
    275                
    276                memset(Receive_Data,0,Receive_REC_LEN);//Çå¿Õ½ÓÊÕÊý×é
   \                     ??DataHandling_485_6:
   \   0000EF                ; Setup parameters for call to function memset
   \   0000EF   75..C8       MOV     ?V0 + 0,#-0x38
   \   0000F2   75..00       MOV     ?V0 + 1,#0x0
   \   0000F5   78..         MOV     R0,#?V0 + 0
   \   0000F7   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000FA   7C00         MOV     R4,#0x0
   \   0000FC   7D00         MOV     R5,#0x0
   \   0000FE   7A..         MOV     R2,#Receive_Data & 0xff
   \   000100   7B..         MOV     R3,#(Receive_Data >> 8) & 0xff
   \   000102   12....       LCALL   ??memset?relay
   \   000105   7402         MOV     A,#0x2
   \   000107   12....       LCALL   ?DEALLOC_XSTACK8
    277                USART1_RX_STA = 0;
   \   00010A   90....       MOV     DPTR,#USART1_RX_STA
   \   00010D   E4           CLR     A
   \   00010E   F0           MOVX    @DPTR,A
   \   00010F   A3           INC     DPTR
   \   000110   8002         SJMP    ??DataHandling_485_7
    278            }
    279            else Return_Value = 1;
   \                     ??DataHandling_485_1:
   \   000112   7401         MOV     A,#0x1
   \                     ??DataHandling_485_7:
   \   000114   F0           MOVX    @DPTR,A
    280          
    281            return Return_Value;	//·µ»Ø½ÓÊÕÇé¿ö
   \   000115   90....       MOV     DPTR,#??Return_Value
   \   000118   E0           MOVX    A,@DPTR
   \   000119   F9           MOV     R1,A
   \   00011A   02....       LJMP    ??Subroutine9_0 & 0xFFFF
    282          }

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??i_1:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??Return_Value:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??Crc16Check:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    283          
    284          //==========================================================
    285          //	º¯ÊýÃû³Æ£º	calcByte()
    286          //
    287          //	º¯Êý¹¦ÄÜ£º	CRC_16×Ö½Ú¼ÆËãº¯Êý
    288          //
    289          //	Èë¿Ú²ÎÊý£º	crc:CRCÐ£ÑéÂë
    290          //			b:
    291          //              
    292          //	·µ»Ø²ÎÊý£º	ÎÞ
    293          //
    294          //	ËµÃ÷£º		
    295          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    296          uint16_t calcByte(uint16_t crc, uint8_t b)
   \                     calcByte:
    297          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    298              static uint16_t i = 0;	//Çå¿ÕÊý×éÊ±ForÑ­»·Ê¹ÓÃ	
    299              crc = crc ^ (int)b << 8;
   \   000004   E9           MOV     A,R1
   \   000005   6B           XRL     A,R3
   \   000006   FB           MOV     R3,A
    300              for (i = 0; i < 8; i++)
   \   000007   90....       MOV     DPTR,#??i_2
   \   00000A   E4           CLR     A
   \   00000B   F0           MOVX    @DPTR,A
   \   00000C   A3           INC     DPTR
   \   00000D   F0           MOVX    @DPTR,A
    301              {
    302                  if ((crc & 0x8000) == 0x8000)
   \                     ??calcByte_0:
   \   00000E   EA           MOV     A,R2
   \   00000F   FC           MOV     R4,A
   \   000010   EB           MOV     A,R3
   \   000011   FD           MOV     R5,A
   \   000012   EC           MOV     A,R4
   \   000013   C3           CLR     C
   \   000014   33           RLC     A
   \   000015   FC           MOV     R4,A
   \   000016   ED           MOV     A,R5
   \   000017   33           RLC     A
   \   000018   FD           MOV     R5,A
   \   000019   EB           MOV     A,R3
   \   00001A   5480         ANL     A,#0x80
   \   00001C   6009         JZ      ??calcByte_1
    303                  {
    304                      crc = crc << 1 ^ 0x1021;
   \   00001E   EC           MOV     A,R4
   \   00001F   6421         XRL     A,#0x21
   \   000021   FA           MOV     R2,A
   \   000022   ED           MOV     A,R5
   \   000023   6410         XRL     A,#0x10
   \   000025   8003         SJMP    ??calcByte_2
    305                  }
    306                  else
    307                  {
    308                      crc = crc << 1;
   \                     ??calcByte_1:
   \   000027   EC           MOV     A,R4
   \   000028   FA           MOV     R2,A
   \   000029   ED           MOV     A,R5
   \                     ??calcByte_2:
   \   00002A   FB           MOV     R3,A
    309                  }
    310              }
   \   00002B   90....       MOV     DPTR,#??i_2
   \   00002E   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   000031   F0           MOVX    @DPTR,A
   \   000032   90....       MOV     DPTR,#??i_2
   \   000035   C3           CLR     C
   \   000036   E0           MOVX    A,@DPTR
   \   000037   9408         SUBB    A,#0x8
   \   000039   A3           INC     DPTR
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   9400         SUBB    A,#0x0
   \   00003D   40CF         JC      ??calcByte_0
    311              return crc & 0xffff;
   \   00003F   02....       LJMP    ?Subroutine0 & 0xFFFF
    312          }

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??i_2:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    313          
    314          //==========================================================
    315          //	º¯ÊýÃû³Æ£º	CRC_16()
    316          //
    317          //	º¯Êý¹¦ÄÜ£º	CRC_16¼ÆËãº¯Êý
    318          //
    319          //	Èë¿Ú²ÎÊý£º	*p:	ÐèÒªÐ£ÑéµÄÊý¾Ý
    320          //			length: Ð£ÑéÊý¾Ý³¤¶È
    321          //              
    322          //	·µ»Ø²ÎÊý£º	wCRC16:16Î»CRCÐ£ÑéÂë
    323          //
    324          //	ËµÃ÷£º		
    325          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    326          uint16_t CRC_16(void *p, int length)
   \                     CRC_16:
    327          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   8C..         MOV     ?V0 + 0,R4
   \   00000B   8D..         MOV     ?V0 + 1,R5
    328              short wCRC16=0;
   \   00000D   7A00         MOV     R2,#0x0
   \   00000F   7B00         MOV     R3,#0x0
    329              uint8_t *pBuffer;
    330              static uint16_t i = 0;  //Çå¿ÕÊý×éÊ±ForÑ­»·Ê¹ÓÃ	
    331          
    332              if (( p==0 )||( length==0 ))
   \   000011   EE           MOV     A,R6
   \   000012   4F           ORL     A,R7
   \   000013   6005         JZ      ??CRC_16_0
   \   000015   EC           MOV     A,R4
   \   000016   45..         ORL     A,?V0 + 1
   \   000018   7004         JNZ     ??CRC_16_1
    333              {
    334                  return 0xFFFF;
   \                     ??CRC_16_0:
   \   00001A   1A           DEC     R2
   \   00001B   1B           DEC     R3
   \   00001C   8031         SJMP    ??CRC_16_2
    335              }
    336          
    337              pBuffer=(uint8_t *)p;
    338              for ( i = 0; i < length; i++)
   \                     ??CRC_16_1:
   \   00001E   90....       MOV     DPTR,#??i_3
   \   000021   E4           CLR     A
   \   000022   F0           MOVX    @DPTR,A
   \   000023   A3           INC     DPTR
   \   000024   801B         SJMP    ??CrossCallReturnLabel_8
    339              {
    340                  wCRC16 = calcByte(wCRC16, pBuffer[i]);
   \                     ??CRC_16_3:
   \   000026                ; Setup parameters for call to function calcByte
   \   000026   90....       MOV     DPTR,#??i_3
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F8           MOV     R0,A
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F9           MOV     R1,A
   \   00002E   EE           MOV     A,R6
   \   00002F   28           ADD     A,R0
   \   000030   F582         MOV     DPL,A
   \   000032   EF           MOV     A,R7
   \   000033   39           ADDC    A,R1
   \   000034   F583         MOV     DPH,A
   \   000036   E0           MOVX    A,@DPTR
   \   000037   F9           MOV     R1,A
   \   000038   12....       LCALL   ??calcByte?relay
    341              }
   \   00003B   90....       MOV     DPTR,#??i_3
   \   00003E   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_8:
   \   000041   F0           MOVX    @DPTR,A
   \   000042   90....       MOV     DPTR,#??i_3
   \   000045   C3           CLR     C
   \   000046   E0           MOVX    A,@DPTR
   \   000047   95..         SUBB    A,?V0 + 0
   \   000049   A3           INC     DPTR
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   95..         SUBB    A,?V0 + 1
   \   00004D   40D7         JC      ??CRC_16_3
    342          
    343              return wCRC16;
   \                     ??CRC_16_2:
   \   00004F   02....       LJMP    ?Subroutine2 & 0xFFFF
    344          }

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??i_3:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    345          
    346          //==========================================================
    347          //	º¯ÊýÃû³Æ£º	Rs485_delay_ms()
    348          //
    349          //	º¯Êý¹¦ÄÜ£º	ºÁÃëÑÓÊ±º¯Êý
    350          //
    351          //	Èë¿Ú²ÎÊý£º	ÎÞ
    352          //
    353          //	·µ»Ø²ÎÊý£º	ÎÞ
    354          //
    355          //	ËµÃ÷£º		
    356          //==========================================================

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    357          void Rs485_delay_ms(unsigned int nms)
   \                     Rs485_delay_ms:
    358          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    359              unsigned int i = 0,j = 0;
    360              
    361              for(i = 0;i<nms;i++)
   \   000000   7800         MOV     R0,#0x0
   \   000002   7900         MOV     R1,#0x0
   \   000004   8008         SJMP    ??Rs485_delay_ms_0
    362              {
    363                  for(j = 0;j<9600;j++)
   \                     ??Rs485_delay_ms_1:
   \   000006   E8           MOV     A,R0
   \   000007   2401         ADD     A,#0x1
   \   000009   08           INC     R0
   \   00000A   E9           MOV     A,R1
   \   00000B   3400         ADDC    A,#0x0
   \   00000D   F9           MOV     R1,A
   \                     ??Rs485_delay_ms_0:
   \   00000E   C3           CLR     C
   \   00000F   E8           MOV     A,R0
   \   000010   9A           SUBB    A,R2
   \   000011   E9           MOV     A,R1
   \   000012   9B           SUBB    A,R3
   \   000013   40F1         JC      ??Rs485_delay_ms_1
    364                  {;}
    365              }
    366          }
   \   000015   02....       LJMP    ?BRET

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_e1e2e3e4:
   \   000000   E4E3E2E1     DD 3789743076

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_eaebeced:
   \   000000   EDECEBEA     DD 3941330157

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Rs485_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Rs485_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Tx_Stack_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Tx_Stack_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Rx_Stack_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Rx_Stack_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Rs485_Send?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Rs485_Send

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Rs485_Receive?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Rs485_Receive

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??DataHandling_485?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    DataHandling_485

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??calcByte?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    calcByte

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??CRC_16?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    CRC_16

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Rs485_delay_ms?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Rs485_delay_ms

   Maximum stack usage in bytes:

     Function               ISTACK PSTACK XSTACK
     --------               ------ ------ ------
     CRC_16                     0      0     24
       -> calcByte              0      0     24
     DataHandling_485           1      0     12
       -> CRC_16                0      0     20
       -> memset                0      0     24
     Rs485_Init                 2      0      0
       -> Rx_Stack_Init         4      0      0
       -> Tx_Stack_Init         4      0      0
     Rs485_Receive              3      0      0
     Rs485_Send                 1      0     16
       -> CRC_16                0      0     24
       -> Rs485_delay_ms        0      0     24
       -> USART1_SendString     0      0     24
       -> Rs485_delay_ms        0      0     24
     Rs485_delay_ms             0      0     12
     Rx_Stack_Init              0      0     12
       -> memset                0      0     24
     Tx_Stack_Init              0      0     12
       -> memset                0      0     24
     calcByte                   2      0     12


   Segment part sizes:

     Function/Label           Bytes
     --------------           -----
     _A_P1                       1
     P1SEL                       1
     P1DIR                       1
     Send_Data                 200
     Receive_Data              200
     Tx_Stack                  218
     Rx_Stack                  218
     Rs485_Init                 18
     ?Subroutine0                7
     Tx_Stack_Init              58
     ?Subroutine1                3
     ??Subroutine9_0             5
     ?Subroutine4               24
     Rx_Stack_Init              60
     Rs485_Send                338
     ?Subroutine2                5
     ?Subroutine3                9
     ?Subroutine7               11
     ?Subroutine6               14
     ?Subroutine8                9
     i                           2
     Rs485_Receive             216
     ?Subroutine5                4
     End_Flag                    1
     Header_Flag                 1
     Receive_Flag                1
     DataHandling_485          285
     i                           2
     Return_Value                1
     Crc16Check                  2
     calcByte                   66
     i                           2
     CRC_16                     82
     i                           2
     Rs485_delay_ms             24
     __Constant_e1e2e3e4         4
     __Constant_eaebeced         4
     ??Rs485_Init?relay          6
     ??Tx_Stack_Init?relay       6
     ??Rx_Stack_Init?relay       6
     ??Rs485_Send?relay          6
     ??Rs485_Receive?relay       6
     ??DataHandling_485?relay    6
     ??calcByte?relay            6
     ??CRC_16?relay              6
     ??Rs485_delay_ms?relay      6

 
 1 238 bytes in segment BANKED_CODE
    54 bytes in segment BANK_RELAYS
     3 bytes in segment SFR_AN
     8 bytes in segment XDATA_ROM_C
   850 bytes in segment XDATA_Z
 
 1 292 bytes of CODE  memory
     0 bytes of CONST memory (+ 8 bytes shared)
     0 bytes of DATA  memory (+ 3 bytes shared)
   850 bytes of XDATA memory

Errors: none
Warnings: 1
